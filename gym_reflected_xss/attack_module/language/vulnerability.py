#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# This file is part of the Wapiti project (http://wapiti.sourceforge.io)
# Copyright (C) 2013-2020 Nicolas Surribas
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
# from gym_reflected_xss.attack_module.language.language import _


class GenericObservation:
    # Constants
    MSG_EVIL_URL = ("  Evil url: {0}")
    MSG_PARAM_INJECT = ("{0} in {1} via injection in the parameter {2}")
    MSG_FROM = ("  coming from {0}")
    MSG_QS_INJECT = ("{0} in {1} via injection in the query string")
    MSG_PATH_INJECT = ("{0} in {1} via injection in the resource path")
    MSG_EVIL_PARAM = ("Involved parameter: {0}")
    MSG_EVIL_REQUEST = ("Evil request:")

    HIGH_LEVEL = "1"
    MEDIUM_LEVEL = "2"
    LOW_LEVEL = "3"

    def __init__(self):
        self.name = ""
        self.description = ""
        self.solution = ""
        self.references = {}

    def get_name(self):
        return self.name

    def get_description(self):
        return self.description

    def get_solution(self):
        return self.solution

    def get_references(self):
        return self.references

    def set_name(self, name):
        self.name = name

    def set_description(self, description):
        self.description = description

    def set_solution(self, solution):
        self.solution = solution

    def set_references(self, references):
        self.references = references


class Notice(GenericObservation):
    # Constants
    ERROR_404 = ("File not found message")


class Vulnerability(Notice):
    # Constants
    SQL_INJECTION = ("SQL Injection")
    BLIND_SQL_INJECTION = ("Blind SQL Injection")
    FILE_HANDLING = ("File Handling")
    XSS = ("Cross Site Scripting")
    CRLF = ("CRLF Injection")
    EXEC = ("Commands execution")
    HTACCESS = ("Htaccess Bypass")
    BACKUP = ("Backup file")
    NIKTO = ("Potentially dangerous file")
    SSRF = ("Server Side Request Forgery")
    REDIRECT = ("Open Redirect")
    XXE = ("XXE")


class Anomaly(Notice):
    # Constants
    ERROR_500 = ("Internal Server Error")
    RES_CONSUMPTION = ("Resource consumption")

    MSG_500 = ("Received a HTTP 500 error in {0}")
    MSG_TIMEOUT = ("Timeout occurred in {0}")

    MSG_QS_TIMEOUT = ("The request timed out while attempting to inject a payload in the query string")
    MSG_PATH_TIMEOUT = ("The request timed out while attempting to inject a payload in the resource path")
    MSG_PARAM_TIMEOUT = ("The request timed out while attempting to inject a payload in the parameter {0}")

    MSG_QS_500 = ("The server responded with a 500 HTTP error code "
                   "while attempting to inject a payload in the query string")
    MSG_PATH_500 = ("The server responded with a 500 HTTP error code "
                     "while attempting to inject a payload in the resource path")
    MSG_PARAM_500 = ("The server responded with a 500 HTTP error code "
                      "while attempting to inject a payload in the parameter {0}")


# The only reason those lines are here is to allow the translation script to find them
("Backup file description")
("Backup file solution")

("Blind SQL Injection description")
("Blind SQL Injection solution")

("Commands execution description")
("Commands execution solution")

("CRLF description")
("CRLF solution")

("Cross Site Scripting description")
("Cross Site Scripting solution")

("File Handling description")
("File Handling solution")

("Htaccess bypass description")
("Htaccess bypass solution")

("Internal server error description")
("Internal server error solution")

("Potentially dangerous file description")
("Potentially dangerous file solution")

("Resource consumption description")
("Resource consumption solution")

("SQL Injection description")
("SQL Injection solution")

("Server Side Request Forgery description")
("Server Side Request Forgery solution")

("Open Redirect description")
("Open Redirect solution")

("XXE description")
("XXE solution")